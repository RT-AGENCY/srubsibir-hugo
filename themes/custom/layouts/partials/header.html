<header class="header">
  <div class="header-top">
    <div class="container header-top-wrapper">
      <button class="mobile-menu-toggle" id="mobile-menu-toggle" aria-label="Открыть меню">
        <span></span>
        <span></span>
        <span></span>
      </button>
      <div class="logo">
        <a href="{{ .Site.BaseURL }}">
          <img src="/images/logotop.png" alt="{{ .Site.Title }}" class="logo-img">
          <!-- <span class="logo-text">{{ .Site.Title }}</span> -->
        </a>
      </div>
      <div class="mobile-actions">
        <!-- Иконка телефона на мобилке -->
        <a href="tel:88005519592">
          <svg class="phone-icon mobile-phone-icon" width="32" height="32" viewBox="0 0 24 24" fill="none"
            xmlns="http://www.w3.org/2000/svg">
            <path
              d="M22 16.92V19.92C22.0011 20.1985 21.9441 20.4742 21.8325 20.7293C21.7209 20.9845 21.5573 21.2136 21.3521 21.4019C21.1468 21.5901 20.9046 21.7335 20.6407 21.8227C20.3769 21.9119 20.0974 21.9451 19.82 21.92C16.7428 21.5856 13.787 20.5341 11.19 18.85C8.77382 17.3147 6.72533 15.2662 5.18999 12.85C3.49997 10.2412 2.44824 7.27099 2.11999 4.18C2.095 3.90347 2.12787 3.62476 2.21649 3.36162C2.30512 3.09849 2.44756 2.85669 2.63476 2.65162C2.82196 2.44655 3.0498 2.28271 3.30379 2.17052C3.55777 2.05833 3.83233 2.00026 4.10999 2H7.10999C7.59544 1.99522 8.06544 2.16708 8.43999 2.48353C8.81454 2.79999 9.06991 3.23945 9.15999 3.72C9.3281 4.68007 9.62478 5.60273 10.04 6.47C10.1856 6.76352 10.2463 7.0958 10.2145 7.42552C10.1826 7.75524 10.0595 8.06886 9.85999 8.32L8.48999 9.69C9.90011 12.1417 11.8583 14.0999 14.31 15.51L15.68 14.14C15.9311 13.9405 16.2447 13.8174 16.5745 13.7855C16.9042 13.7537 17.2365 13.8144 17.53 13.96C18.3973 14.3752 19.3199 14.6719 20.28 14.84C20.7658 14.9305 21.2094 15.1905 21.5265 15.5705C21.8437 15.9505 22.0122 16.4251 21.9999 16.92H22Z"
              stroke="#8c8c8c" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
          </svg>
        </a>

        <!-- Иконка поиска на мобилке -->
        <button class="mobile-search-toggle" id="mobile-search-toggle" aria-label="Открыть поиск">
          <svg class="search-icon" width="24" height="24" viewBox="0 0 24 24" fill="none"
            xmlns="http://www.w3.org/2000/svg">
            <circle cx="11" cy="11" r="8" stroke="#8c8c8c" stroke-width="2" />
            <path d="m21 21-4.35-4.35" stroke="#8c8c8c" stroke-width="2" stroke-linecap="round"
              stroke-linejoin="round" />
          </svg>
        </button>
      </div>

      <div class="header-search">
        <form class="search-form" id="searchForm" method="get" action="/search/">
          <div class="search-form__fake-input">
            <input type="text" class="search-form__input" name="query" id="searchInput" placeholder="Поиск по сайту"
              autocomplete="off">
            <button class="search-form__button" type="submit">
              <svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none"
                xmlns="http://www.w3.org/2000/svg">
                <circle cx="11" cy="11" r="8" stroke="#8c8c8c" stroke-width="2" />
                <path d="m21 21-4.35-4.35" stroke="#8c8c8c" stroke-width="2" stroke-linecap="round"
                  stroke-linejoin="round" />
              </svg>
            </button>
          </div>
          <!-- Выпадающий список результатов -->
          <!-- <div class="search-results" id="searchResults" style="display: none;"></div> -->
        </form>
      </div>
      <a class="header__button_call callback-btn" data-id="modal-call">Заказать обратный звонок</a>
      <div class="header-contact">
        <div class="header-contact-info">
          <span>График работы:</span>
          <span>Пн-Сб 9.00-20.00</span>
        </div>
        <div class="header-contact-info">
          <a class="header-contact-phone" href="tel:{{ .Site.Params.phone }}">{{ .Site.Params.phone }}</a>
          <a class="header-contact-phone" href="tel:89030770399">8 903 077 0399</a>
        </div>
        <div class="header-contact-info">
          <span>{{ .Site.Params.address }}</span>
          <a class="header-contact-phone" href="mailto:{{ .Site.Params.email }}">{{ .Site.Params.email }}</a>
        </div>
      </div>
    </div>
  </div>

  <!-- Мобильный поиск (выдвигается сверху) -->
  <div class="mobile-search" id="mobile-search">
    <div class="container">
      <form class="search-form mobile-search-form" method="get" action="/search/">
        <div class="search-form__fake-input">
          <input type="text" class="search-form__input" name="query" id="mobileSearchInput" placeholder="Поиск по сайту"
            autocomplete="off">
          <button class="search-form__button" type="submit">
            <svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none"
              xmlns="http://www.w3.org/2000/svg">
              <circle cx="11" cy="11" r="8" stroke="#8c8c8c" stroke-width="2" />
              <path d="m21 21-4.35-4.35" stroke="#8c8c8c" stroke-width="2" stroke-linecap="round"
                stroke-linejoin="round" />
            </svg>
          </button>
          <button type="button" class="mobile-search-close" id="mobile-search-close">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M18 6L6 18" stroke="#8c8c8c" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
              <path d="M6 6L18 18" stroke="#8c8c8c" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
          </button>
        </div>
        <!-- Результаты поиска для мобилки -->
        <div class="search-results mobile-search-results" id="mobileSearchResults" style="display: none;"></div>
      </form>
    </div>
  </div>



  <div class="header-main">
    <div class="container">
      <div class="header-content">


        <nav class="nav" id="main-nav">
          {{ range .Site.Menus.main }}
          {{ if or (eq .Name "Проекты") (eq .Name "Услуги") (eq .Name "О компании") }}
          <div class="nav-dropdown">
            <a href="{{ .URL }}" class="nav-link">{{ .Name }}</a>
            <div class="dropdown-content">
              {{ if eq .Name "Проекты" }}
              <!-- Подменю для Проектов -->
              <div class="dropdown-section">
                <h4>Проекты</h4>
                <a href="/projects/">Все проекты</a>
                <a href="/projects/?material=сосна">Сруб из сосны</a>
                <a href="/projects/?material=лиственница">Сруб из лиственницы</a>
                <a href="/projects/?material=кедр">Элитные дома из кедра</a>
                <a href="/projects/?category=Баня">Сруб бани под ключ</a>
                <!-- <a href="/projects/?material=сосна">Проекты домов Post and Beam</a> -->
              </div>
              {{ end }}

              {{ if eq .Name "Услуги" }}
              <!-- Подменю для Услуг -->
              <!-- <div class="dropdown-section">
                <a href="/services/">Срубы бань из бревна</a>
                <a href="/services/">Дома из сосны</a>
                <a href="/services/">Дома из кедра</a>
                <a href="/services/">Дома POST&BEAM</a>
                <a href="/services/">Дома из лиственницы</a>
              </div> -->
              <div class="dropdown-section">
                <a href="/services/proekty-domov">Проектирование домов</a>
                <a href="/services/montazh-i-remont-kryshi">Монтаж и ремонт кровли</a>
                <a href="/services/stroitelnye-materialy">Строительные материалы</a>
              </div>
              {{ end }}
              {{ if eq .Name "О компании" }}
              <!-- Подменю для О компании -->
              <div class="dropdown-section">
                <a href="/reviews/">Отзывы</a>
                <a href="/about/">О компании</a>
                <!-- <a href="/about/">Наши работы</a> -->
                <!-- <a href="/about/">Наши технологии</a> -->
                <a href="/payment-delivery/">Оплата и Доставка</a>
                <a href="/discounts/">Скидки</a>
              </div>
              {{ end }}

              <!-- Каталог кнопка -->
              {{ if eq .Name "Проекты" }}
              <div class="dropdown-catalog">
                <a href="/projects/" class="catalog-btn projects-btn">Все проекты</a>
              </div>
              {{ end }}

              {{ if eq .Name "Услуги" }}
              <div class="dropdown-catalog">
                <a href="/services/" class="catalog-btn services-btn">Все услуги</a>
              </div>
              {{ end }}
            </div>
          </div>
          {{ else }}
          <a href="{{ .URL }}" class='nav-link {{ if $.IsMenuCurrent " main" . }}active{{ end }}'>
            {{ .Name }}
          </a>
          {{ end }}
          {{ end }}
        </nav>


      </div>
    </div>
  </div>

  <!-- Мобильное меню -->
  <div class="mobile-menu" id="mobile-menu">
    <div class="mobile-menu-content">
      <!-- Заголовок с кнопкой закрытия и заказом звонка -->
      <div class="mobile-menu-header">
        <button class="mobile-menu-close" id="mobile-menu-close" aria-label="Закрыть меню">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M18 6L6 18" stroke="currentColor" stroke-width="2" stroke-linecap="round"
              stroke-linejoin="round" />
            <path d="M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round"
              stroke-linejoin="round" />
          </svg>
        </button>
        <a class="mobile-callback-btn" href="#" data-id="modal-call">Заказать обратный звонок</a>
      </div>

      <!-- Контактная информация -->
      <div class="mobile-contact-section">
        <div class="contact-item">
          <svg class="contact-icon" viewBox="0 0 24 24" fill="currentColor">
            <path
              d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z" />
          </svg>
          <div class="contact-text">
            <div class="contact-title">{{ .Site.Params.address }}</div>
            <div class="contact-subtitle">info@ideisruba.ru<br>по всем вопросам</div>
          </div>
        </div>

        <div class="contact-item">
          <svg class="contact-icon" viewBox="0 0 24 24" fill="currentColor">
            <path
              d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z" />
          </svg>
          <div class="contact-text">
            <a class="contact-title phone-number" href="tel:{{ .Site.Params.phone }}">{{ .Site.Params.phone }}</a>

          </div>
        </div>

        <div class="contact-item">
          <svg class="contact-icon" viewBox="0 0 24 24" fill="currentColor">
            <path
              d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z" />
          </svg>
          <div class="contact-text">
            <a class="contact-title phone-number" href="tel:89030770399">8 903 077 0399</a>
            <div class="contact-subtitle">
              График работы: Пн-Сб 9.00-20.00
            </div>
          </div>
        </div>
      </div>

      <!-- Навигационные секции с подменю -->
      <div class="mobile-nav-sections">
        <!-- Проекты -->
        <div class="nav-section">
          <div class="nav-header" onclick="toggleMobileSubmenu('projects')">
            Проекты
            <svg class="arrow" id="projects-arrow" viewBox="0 0 24 24" fill="currentColor">
              <path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z" />
            </svg>
          </div>
          <div class="nav-submenu" id="projects-submenu">
            <a class="nav-item" href="/projects/">Все проекты</a>
            <a class="nav-item" href="/projects/?material=сосна">Сруб из сосны</a>
            <a class="nav-item" href="/projects/?material=лиственница">Сруб из лиственницы</a>
            <a class="nav-item" href="/projects/">Элитные дома из кедра</a>
            <a class="nav-item" href="/projects/">Сруб бани под ключ</a>
            <!-- <a class="nav-item" href="/projects/">Проекты домов Post and Beam</a> -->
          </div>
        </div>

        <!-- Услуги -->
        <div class="nav-section">
          <div class="nav-header" onclick="toggleMobileSubmenu('services')">
            Услуги
            <svg class="arrow" id="services-arrow" viewBox="0 0 24 24" fill="currentColor">
              <path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z" />
            </svg>
          </div>
          <div class="nav-submenu" id="services-submenu">
            <!-- <a class="nav-item" href="/services/">Срубы бань из бревна</a> -->
            <!-- <a class="nav-item" href="/services/">Дома из сосны</a> -->
            <!-- <a class="nav-item" href="/services/">Дома из кедра</a> -->
            <!-- <a class="nav-item" href="/services/">Дома POST&BEAM</a> -->
            <!-- <a class="nav-item" href="/services/">Дома из лиственницы</a> -->
            <a class="nav-item" href="/uslugi/proekty-domov">Проектирование домов</a>
            <a class="nav-item" href="/uslugi/montazh-i-remont-kryshi">Монтаж и ремонт кровли</a>
            <a class="nav-item" href="/uslugi/stroitelnye-materialy">Строительные материалы</a>
          </div>
        </div>

        <!-- О компании -->
        <div class="nav-section">
          <div class="nav-header" onclick="toggleMobileSubmenu('about')">
            О компании
            <svg class="arrow" id="about-arrow" viewBox="0 0 24 24" fill="currentColor">
              <path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z" />
            </svg>
          </div>
          <div class="nav-submenu" id="about-submenu">
            <a class="nav-item" href="/reviews/">Отзывы</a>
            <a class="nav-item" href="/about/">О компании</a>
            <!-- <a class="nav-item" href="/about/">Наши работы</a> -->
            <!-- <a class="nav-item" href="/about/">Наши технологии</a> -->
            <a class="nav-item" href="/payment-delivery/">Оплата и Доставка</a>
            <a class="nav-item" href="/discounts/">Скидки</a>
          </div>
        </div>

        <!-- Стандартные ссылки из меню Hugo -->
        {{ range .Site.Menus.main }}
        <a href="{{ .URL }}" class="mobile-nav-link">{{ .Name }}</a>
        {{ end }}
      </div>
    </div>
  </div>

  <script>
    function toggleMobileSubmenu(section) {
      const submenu = document.getElementById(section + '-submenu');
      const arrow = document.getElementById(section + '-arrow');
      const header = arrow.parentElement;

      const isOpen = submenu.classList.contains('open');

      // Закрыть все другие подменю
      document.querySelectorAll('.nav-submenu').forEach(menu => {
        menu.classList.remove('open');
      });
      document.querySelectorAll('.arrow').forEach(arr => {
        arr.classList.remove('rotated');
      });
      document.querySelectorAll('.nav-header').forEach(head => {
        head.classList.remove('active');
      });

      // Если подменю было закрыто, открыть его
      if (!isOpen) {
        submenu.classList.add('open');
        arrow.classList.add('rotated');
        header.classList.add('active');
      }
    }

    // Добавить обработчик для существующей кнопки закрытия меню
    document.addEventListener('DOMContentLoaded', function () {
      const closeBtn = document.getElementById('mobile-menu-close');
      if (closeBtn) {
        closeBtn.addEventListener('click', function () {
          document.getElementById('mobile-menu').classList.remove('active');
          document.body.classList.remove('menu-open');
        });
      }
    });
  </script>
</header>