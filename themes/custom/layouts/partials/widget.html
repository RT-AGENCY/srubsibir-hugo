<!-- Фиксированный виджет связи -->
<div class="contact-widget" id="contactWidget">
  <div class="contact-widget-main" id="contactWidgetMain">
    <div class="contact-widget-icon">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
          d="M22 16.92V19.92C22.0011 20.1985 21.9441 20.4742 21.8325 20.7293C21.7209 20.9845 21.5573 21.2136 21.3521 21.4019C21.1468 21.5901 20.9046 21.7335 20.6407 21.8227C20.3769 21.9119 20.0974 21.9451 19.82 21.92C16.7428 21.5856 13.787 20.5341 11.19 18.85C8.77382 17.3147 6.72533 15.2662 5.18999 12.85C3.49997 10.2412 2.44824 7.27099 2.11999 4.18C2.095 3.90347 2.12787 3.62476 2.21649 3.36162C2.30512 3.09849 2.44756 2.85669 2.63476 2.65162C2.82196 2.44655 3.0498 2.28271 3.30379 2.17052C3.55777 2.05833 3.83233 2.00026 4.10999 2H7.10999C7.59544 1.99522 8.06544 2.16708 8.43999 2.48353C8.81454 2.79999 9.06991 3.23945 9.15999 3.72C9.3281 4.68007 9.62478 5.60273 10.04 6.47C10.1856 6.76352 10.2463 7.0958 10.2145 7.42552C10.1826 7.75524 10.0595 8.06886 9.85999 8.32L8.48999 9.69C9.90011 12.1417 11.8583 14.0999 14.31 15.51L15.68 14.14C15.9311 13.9405 16.2447 13.8174 16.5745 13.7855C16.9042 13.7537 17.2365 13.8144 17.53 13.96C18.3973 14.3752 19.3199 14.6719 20.28 14.84C20.7658 14.9305 21.2094 15.1905 21.5265 15.5705C21.8437 15.9505 22.0122 16.4251 21.9999 16.92H22Z"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
      </svg>
    </div>
    <span class="contact-widget-text">Связаться</span>
  </div>

  <!-- Выпадающее меню виджета -->
  <div class="contact-widget-dropdown" id="contactWidgetDropdown">
    <div class="contact-widget-header">
      <h3>Свяжитесь с нами</h3>
      <button class="contact-widget-close" id="contactWidgetClose">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M18 6L6 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
          <path d="M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
        </svg>
      </button>
    </div>

    <div class="contact-widget-content">
      <div class="contact-widget-options">
        <a href="tel:88005519592" class="contact-widget-option">
          <div class="contact-option-icon phone-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M22 16.92V19.92C22.0011 20.1985 21.9441 20.4742 21.8325 20.7293C21.7209 20.9845 21.5573 21.2136 21.3521 21.4019C21.1468 21.5901 20.9046 21.7335 20.6407 21.8227C20.3769 21.9119 20.0974 21.9451 19.82 21.92C16.7428 21.5856 13.787 20.5341 11.19 18.85C8.77382 17.3147 6.72533 15.2662 5.18999 12.85C3.49997 10.2412 2.44824 7.27099 2.11999 4.18C2.095 3.90347 2.12787 3.62476 2.21649 3.36162C2.30512 3.09849 2.44756 2.85669 2.63476 2.65162C2.82196 2.44655 3.0498 2.28271 3.30379 2.17052C3.55777 2.05833 3.83233 2.00026 4.10999 2H7.10999C7.59544 1.99522 8.06544 2.16708 8.43999 2.48353C8.81454 2.79999 9.06991 3.23945 9.15999 3.72C9.3281 4.68007 9.62478 5.60273 10.04 6.47C10.1856 6.76352 10.2463 7.0958 10.2145 7.42552C10.1826 7.75524 10.0595 8.06886 9.85999 8.32L8.48999 9.69C9.90011 12.1417 11.8583 14.0999 14.31 15.51L15.68 14.14C15.9311 13.9405 16.2447 13.8174 16.5745 13.7855C16.9042 13.7537 17.2365 13.8144 17.53 13.96C18.3973 14.3752 19.3199 14.6719 20.28 14.84C20.7658 14.9305 21.2094 15.1905 21.5265 15.5705C21.8437 15.9505 22.0122 16.4251 21.9999 16.92H22Z"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
          </div>
          <div class="contact-option-content">
            <span class="contact-option-title">Позвонить</span>
            <span class="contact-option-subtitle">8 800 551 9592</span>
          </div>
        </a>

        <a href="https://wa.me/79030770399" class="contact-widget-option" target="_blank">
          <div class="contact-option-icon whatsapp-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.451 3.488"
                fill="currentColor" />
            </svg>
          </div>
          <div class="contact-option-content">
            <span class="contact-option-title">WhatsApp</span>
            <span class="contact-option-subtitle">Написать сообщение</span>
          </div>
        </a>

        <button class="contact-widget-option" onclick="showCallbackForm()">
          <div class="contact-option-icon callback-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
          </div>
          <div class="contact-option-content">
            <span class="contact-option-title">Обратный звонок</span>
            <span class="contact-option-subtitle">Мы перезвоним вам</span>
          </div>
        </button>
      </div>

      <div class="contact-widget-info">
        <p><strong>Время работы:</strong></p>
        <p>Пн-Сб: 9:00 - 20:00</p>
      </div>
    </div>
  </div>
</div>

<style>
  /* Основной виджет */
  .contact-widget {
    position: fixed;
    bottom: 20px;
    right: 20px;
    z-index: 9999;
    font-family: Arial, sans-serif;
  }

  .contact-widget-main {
    background: linear-gradient(135deg, #8bc34a, #4a7c59);
    color: white;
    padding: 15px 20px;
    border-radius: 30px;
    cursor: pointer;
    box-shadow: 0 8px 25px rgba(139, 195, 74, 0.3);
    display: flex;
    align-items: center;
    gap: 10px;
    transition: all 0.3s ease;
    user-select: none;
    min-width: 140px;
    justify-content: center;
  }

  .contact-widget-main:hover {
    background: linear-gradient(135deg, #4a7c59, #2c5530);
    transform: translateY(-3px);
    box-shadow: 0 12px 35px rgba(139, 195, 74, 0.4);
  }

  .contact-widget-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 24px;
    height: 24px;
    transition: transform 0.3s ease;
  }

  .contact-widget-main:hover .contact-widget-icon {
    transform: scale(1.1);
  }

  .contact-widget-text {
    font-size: 16px;
    font-weight: 600;
    white-space: nowrap;
  }

  /* Выпадающее меню */
  .contact-widget-dropdown {
    position: absolute;
    bottom: 70px;
    right: 0;
    background: white;
    border-radius: 15px;
    box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
    width: 280px;
    opacity: 0;
    visibility: hidden;
    transform: translateY(10px);
    transition: all 0.3s ease;
    border: 1px solid rgba(139, 195, 74, 0.2);
  }

  .contact-widget.active .contact-widget-dropdown {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
  }

  .contact-widget-header {
    padding: 20px 20px 15px;
    border-bottom: 1px solid #f0f0f0;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .contact-widget-header h3 {
    margin: 0;
    color: #2c5530;
    font-size: 18px;
    font-weight: 700;
  }

  .contact-widget-close {
    background: none;
    border: none;
    color: #666;
    cursor: pointer;
    padding: 5px;
    border-radius: 50%;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .contact-widget-close:hover {
    background: #f0f0f0;
    color: #2c5530;
  }

  .contact-widget-content {
    padding: 15px 20px 20px;
  }

  .contact-widget-options {
    margin-bottom: 15px;
  }

  .contact-widget-option {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 0;
    text-decoration: none;
    color: inherit;
    border: none;
    background: none;
    width: 100%;
    cursor: pointer;
    border-radius: 8px;
    transition: all 0.3s ease;
  }

  .contact-widget-option:hover {
    background: rgba(139, 195, 74, 0.1);
    transform: translateX(3px);
  }

  .contact-option-icon {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    transition: all 0.3s ease;
  }

  .contact-widget .phone-icon {
    background: rgba(34, 139, 34, 0.1);
    color: #228b22;
  }

  .contact-widget .whatsapp-icon {
    background: rgba(37, 211, 102, 0.1);
    color: #25d366;
  }

  .contact-widget .callback-icon {
    background: rgba(139, 195, 74, 0.1);
    color: #8bc34a;
  }

  .contact-widget-option:hover .contact-option-icon {
    transform: scale(1.1);
  }

  .contact-option-content {
    flex: 1;
    text-align: left;
  }

  .contact-option-title {
    display: block;
    font-weight: 600;
    color: #2c5530;
    font-size: 14px;
    margin-bottom: 2px;
  }

  .contact-option-subtitle {
    display: block;
    color: #666;
    font-size: 12px;
  }

  .contact-widget-info {
    border-top: 1px solid #f0f0f0;
    padding-top: 15px;
    text-align: center;
  }

  .contact-widget-info p {
    margin: 0 0 5px 0;
    color: #666;
    font-size: 12px;
  }

  .contact-widget-info strong {
    color: #2c5530;
  }

  /* Анимация пульсации */
  @keyframes pulse {
    0% {
      box-shadow: 0 8px 25px rgba(139, 195, 74, 0.3);
    }

    50% {
      box-shadow: 0 8px 25px rgba(139, 195, 74, 0.5), 0 0 0 10px rgba(139, 195, 74, 0.1);
    }

    100% {
      box-shadow: 0 8px 25px rgba(139, 195, 74, 0.3);
    }
  }

  .contact-widget-main {
    animation: pulse 3s infinite;
  }

  /* Мобильная адаптация */
  @media (max-width: 768px) {
    .contact-widget {
      bottom: 20px;
      right: 20px;
    }

    .contact-widget-main {
      padding: 12px 16px;
      min-width: 120px;
    }

    .contact-widget-text {
      font-size: 14px;
    }

    .contact-widget-dropdown {
      width: 250px;
      right: -20px;
    }

    .contact-widget-icon {
      width: 20px;
      height: 20px;
    }
  }

  @media (max-width: 480px) {
    .contact-widget-dropdown {
      width: calc(100vw - 40px);
      right: -10px;
    }

    .contact-widget-main {
      padding: 10px 14px;
      min-width: 100px;
    }

    .contact-widget-text {
      font-size: 13px;
    }
  }

  /* Анимации появления */
  @keyframes slideInUp {
    from {
      opacity: 0;
      transform: translateY(30px);
    }

    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .contact-widget {
    animation: slideInUp 0.6s ease-out 1s both;
  }
</style>

<script>
  // Функциональность виджета
  document.addEventListener('DOMContentLoaded', function () {
    const widget = document.getElementById('contactWidget');
    const widgetMain = document.getElementById('contactWidgetMain');
    const dropdown = document.getElementById('contactWidgetDropdown');
    const closeBtn = document.getElementById('contactWidgetClose');

    // Открытие/закрытие виджета
    widgetMain.addEventListener('click', function (e) {
      e.stopPropagation();
      widget.classList.toggle('active');
    });

    // Закрытие по кнопке
    closeBtn.addEventListener('click', function (e) {
      e.stopPropagation();
      widget.classList.remove('active');
    });

    // Закрытие при клике вне виджета
    document.addEventListener('click', function (e) {
      if (!widget.contains(e.target)) {
        widget.classList.remove('active');
      }
    });

    // Предотвращаем закрытие при клике внутри дропдауна
    dropdown.addEventListener('click', function (e) {
      e.stopPropagation();
    });

    // Закрытие по Escape
    document.addEventListener('keydown', function (e) {
      if (e.key === 'Escape' && widget.classList.contains('active')) {
        widget.classList.remove('active');
      }
    });
  });

  // Функция для показа формы обратного звонка
  function showCallbackForm() {
    // Здесь можно открыть модальное окно с формой
    // или перенаправить на страницу контактов

    // Пример простого алерта (замените на вашу логику)
    alert('Форма обратного звонка - здесь будет ваша форма');

    // Или перенаправление:
    // window.location.href = '/contact/';

    // Или открытие модального окна:
    // openCallbackModal();
  }

  // Трекинг взаимодействий (опционально)
  function trackWidgetInteraction(action) {
    // Здесь можно добавить аналитику
    console.log('Widget interaction:', action);

    // Пример для Google Analytics:
    // gtag('event', 'contact_widget', {
    //   'event_category': 'engagement',
    //   'event_label': action
    // });
  }

  // Добавляем трекинг к кнопкам
  document.addEventListener('DOMContentLoaded', function () {
    const phoneLink = document.querySelector('a[href^="tel:"]');
    const whatsappLink = document.querySelector('a[href^="https://wa.me/"]');
    const callbackBtn = document.querySelector('button[onclick="showCallbackForm()"]');

    if (phoneLink) {
      phoneLink.addEventListener('click', () => trackWidgetInteraction('phone_call'));
    }
    if (whatsappLink) {
      whatsappLink.addEventListener('click', () => trackWidgetInteraction('whatsapp'));
    }
    if (callbackBtn) {
      callbackBtn.addEventListener('click', () => trackWidgetInteraction('callback_request'));
    }
  });
</script>