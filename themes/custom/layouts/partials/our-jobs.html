<section class="gallery-section">
  <div class="container">
    <h2 class="gallery-title">НАШИ РАБОТЫ</h2>

    <div class="gallery-grid">
      <div class="gallery-item" data-index="0">
        <img src="https://cdn.jsdelivr.net/gh/RT-AGENCY/srubsibir-images@main/main/job/job-1.webp"
          alt="Строительство деревянного дома" loading="lazy">
        <div class="gallery-overlay">
          <div class="gallery-info">
            <h3>Деревянный дом из сосны</h3>
            <p>Строительство коттеджа 120 кв.м</p>
          </div>
        </div>
      </div>

      <div class="gallery-item" data-index="1">
        <img src="https://cdn.jsdelivr.net/gh/RT-AGENCY/srubsibir-images@main/main/job/job-2.webp"
          alt="Строительство бани" loading="lazy">
        <div class="gallery-overlay">
          <div class="gallery-info">
            <h3>Русская баня</h3>
            <p>Баня с комнатой отдыха 40 кв.м</p>
          </div>
        </div>
      </div>

      <div class="gallery-item" data-index="2">
        <img src="https://cdn.jsdelivr.net/gh/RT-AGENCY/srubsibir-images@main/main/job/job-3.webp"
          alt="Деревянный дом с резными элементами" loading="lazy">
        <div class="gallery-overlay">
          <div class="gallery-info">
            <h3>Дом с резными элементами</h3>
            <p>Элитный коттедж из кедра</p>
          </div>
        </div>
      </div>

      <div class="gallery-item" data-index="3">
        <img src="https://cdn.jsdelivr.net/gh/RT-AGENCY/srubsibir-images@main/main/job/job-4.webp"
          alt="Современный деревянный дом" loading="lazy">
        <div class="gallery-overlay">
          <div class="gallery-info">
            <h3>Современный деревянный дом</h3>
            <p>Дом в современном стиле 180 кв.м</p>
          </div>
        </div>
      </div>

      <div class="gallery-item" data-index="4">
        <img src="https://cdn.jsdelivr.net/gh/RT-AGENCY/srubsibir-images@main/main/job/job-5.webp" alt="Двухэтажный дом"
          loading="lazy">
        <div class="gallery-overlay">
          <div class="gallery-info">
            <h3>Двухэтажный дом</h3>
            <p>Просторный семейный дом 220 кв.м</p>
          </div>
        </div>
      </div>

      <div class="gallery-item" data-index="5">
        <img src="https://cdn.jsdelivr.net/gh/RT-AGENCY/srubsibir-images@main/main/job/job-6.webp" alt="Банный комплекс"
          loading="lazy">
        <div class="gallery-overlay">
          <div class="gallery-info">
            <h3>Банный комплекс</h3>
            <p>Баня с террасой и мангальной зоной</p>
          </div>
        </div>
      </div>

      <div class="gallery-item" data-index="6">
        <img src="https://cdn.jsdelivr.net/gh/RT-AGENCY/srubsibir-images@main/main/job/job-7.webp"
          alt="Дом из лиственницы" loading="lazy">
        <div class="gallery-overlay">
          <div class="gallery-info">
            <h3>Дом из лиственницы</h3>
            <p>Прочный и долговечный дом 150 кв.м</p>
          </div>
        </div>
      </div>

      <div class="gallery-item" data-index="7">
        <img src="https://cdn.jsdelivr.net/gh/RT-AGENCY/srubsibir-images@main/main/job/job-8.webp" alt="Дом с мансардой"
          loading="lazy">
        <div class="gallery-overlay">
          <div class="gallery-info">
            <h3>Дом с мансардой</h3>
            <p>Уютный дом с мансардным этажом 160 кв.м</p>
          </div>
        </div>
      </div>
    </div>

    <div class="gallery-actions">
      <button class="btn-primary gallery-btn" onclick="showAllProjects()">Посмотреть все проекты</button>
    </div>
  </div>
</section>

<!-- Модальное окно с лайтбоксом и слайдером -->
<div class="lightbox-modal" id="lightboxModal">
  <div class="lightbox-overlay" onclick="closeLightbox()"></div>
  <div class="lightbox-content">
    <button class="lightbox-close" onclick="closeLightbox()">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M18 6L6 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
        <path d="M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
      </svg>
    </button>

    <div class="swiper lightbox-swiper">
      <div class="swiper-wrapper">
        <!-- Слайды будут добавлены динамически -->
      </div>

      <!-- Навигация -->
      <div class="swiper-button-next lightbox-nav-btn"></div>
      <div class="swiper-button-prev lightbox-nav-btn"></div>

      <!-- Пагинация -->
      <div class="swiper-pagination lightbox-pagination"></div>

      <!-- Счетчик слайдов -->
      <div class="slide-counter">
        <span class="current-slide">1</span>
        <span class="separator">/</span>
        <span class="total-slides">8</span>
      </div>
    </div>

    <!-- Информация о текущем изображении -->
    <div class="lightbox-info">
      <h3 class="lightbox-title">Название проекта</h3>
      <p class="lightbox-description">Описание проекта</p>
    </div>
  </div>
</div>

<style>
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  body {
    font-family: 'Arial', sans-serif;
    line-height: 1.6;
    color: #333;
    background-color: #f8f9fa;
  }

  .container {
    max-width: 1440px;
    margin: 0 auto;
    padding: 0 20px;
  }

  /* Стили галереи */
  .gallery-section {
    padding: 80px 20px;
    background: #F4F3F5;
  }

  .gallery-title {
    text-align: center;
    font-size: 48px;
    font-weight: 700;
    margin-bottom: 50px;
    color: #2c5530;
    position: relative;
    letter-spacing: 2px;
  }

  .gallery-title::before,
  .gallery-title::after {
    content: '';
    position: absolute;
    top: 50%;
    width: 200px;
    height: 3px;
    background: linear-gradient(90deg, transparent, #8bc34a, transparent);
  }

  .gallery-title::before {
    left: -220px;
  }

  .gallery-title::after {
    right: -220px;
  }

  .gallery-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: 20px;
    margin-bottom: 50px;
  }

  .gallery-item {
    position: relative;
    aspect-ratio: 4/3;
    border-radius: 15px;
    overflow: hidden;
    cursor: pointer;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
    transition: all 0.4s ease;
    background: white;
  }

  .gallery-item:hover {
    transform: translateY(-10px) scale(1.02);
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
  }

  .gallery-item img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.4s ease;
  }

  .gallery-item:hover img {
    transform: scale(1.1);
  }

  .gallery-overlay {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: linear-gradient(transparent, rgba(0, 0, 0, 0.8));
    padding: 40px 20px 20px;
    transform: translateY(100%);
    transition: transform 0.4s ease;
  }

  .gallery-item:hover .gallery-overlay {
    transform: translateY(0);
  }

  .gallery-info h3 {
    color: white;
    font-size: 18px;
    font-weight: 600;
    margin-bottom: 8px;
  }

  .gallery-info p {
    color: rgba(255, 255, 255, 0.9);
    font-size: 14px;
  }

  .gallery-actions {
    text-align: center;
  }

  .btn-primary {
    background: linear-gradient(135deg, #8bc34a, #4a7c59);
    color: white;
    padding: 15px 30px;
    border: none;
    border-radius: 25px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    text-transform: uppercase;
    letter-spacing: 1px;
    box-shadow: 0 8px 25px rgba(139, 195, 74, 0.3);
  }

  .btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 12px 35px rgba(139, 195, 74, 0.4);
    background: linear-gradient(135deg, #4a7c59, #2c5530);
  }

  /* Стили лайтбокса */
  .lightbox-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: #1e1e1e;
    z-index: 10000;
    display: none;
    opacity: 0;
    transition: opacity 0.3s ease;
  }

  .lightbox-modal.active {
    display: flex;
    opacity: 1;
  }

  .lightbox-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    cursor: pointer;
  }

  .lightbox-content {
    position: relative;
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 60px 20px 20px;

    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;

    /* Отключаем перетаскивание */
    -webkit-user-drag: none;
    -khtml-user-drag: none;
    -moz-user-drag: none;
    -o-user-drag: none;
  }

  .lightbox-close {
    position: absolute;
    top: 20px;
    right: 20px;
    background: rgba(255, 255, 255, 0.1);
    border: none;
    color: white;
    width: 50px;
    height: 50px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    z-index: 10001;
    backdrop-filter: blur(10px);
  }

  .lightbox-close:hover {
    background: rgba(255, 255, 255, 0.2);
    transform: scale(1.1);
  }

  .lightbox-swiper {
    width: 100%;
    max-width: 90vw;
    max-height: 70vh;
    margin-bottom: 20px;
  }

  .lightbox-swiper .swiper-slide {
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .lightbox-swiper .swiper-slide img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
    border-radius: 10px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
  }

  .lightbox-nav-btn {
    color: white !important;
    background: rgba(255, 255, 255, 0.1) !important;
    width: 50px !important;
    height: 50px !important;
    border-radius: 50% !important;
    margin-top: -25px !important;
    backdrop-filter: blur(10px);
    transition: all 0.3s ease;
  }

  .lightbox-nav-btn:hover {
    background: rgba(255, 255, 255, 0.2) !important;
    transform: scale(1.1);
  }

  .lightbox-nav-btn::after {
    font-size: 20px !important;
    font-weight: 600 !important;
  }

  .lightbox-pagination {
    bottom: -40px !important;
  }

  .lightbox-pagination .swiper-pagination-bullet {
    width: 12px !important;
    height: 12px !important;
    background: rgba(255, 255, 255, 0.5) !important;
    opacity: 1 !important;
    margin: 0 6px !important;
    transition: all 0.3s ease;
  }

  .lightbox-pagination .swiper-pagination-bullet-active {
    background: white !important;
    transform: scale(1.3);
  }

  .separator {
    margin: 0 8px;
    opacity: 0.7;
  }

  .lightbox-info {
    text-align: center;
    color: white;
    max-width: 600px;
  }

  .lightbox-title {
    color: white;
    font-size: 24px;
    font-weight: 600;
    margin-bottom: 10px;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
  }

  .lightbox-description {
    color: white;
    font-size: 16px;
    opacity: 0.9;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
  }

  /* Адаптивность */
  @media (max-width: 1200px) {

    .gallery-title::before,
    .gallery-title::after {
      display: none;
    }
  }

  @media (max-width: 768px) {
    .gallery-section {
      padding: 60px 15px;
    }

    .gallery-title {
      font-size: 32px;
    }

    .gallery-grid {
      grid-template-columns: 1fr;
      gap: 15px;
    }

    .lightbox-content {
      padding: 80px 10px 10px;
    }

    .lightbox-swiper {
      max-width: 95vw;
      max-height: 60vh;
    }

    .lightbox-nav-btn {
      width: 40px !important;
      height: 40px !important;
      margin-top: -20px !important;
    }

    .lightbox-nav-btn::after {
      font-size: 16px !important;
    }

    .lightbox-title {
      font-size: 20px;
    }

    .lightbox-description {
      font-size: 14px;
    }
  }

  @media (max-width: 480px) {
    .gallery-title {
      font-size: 28px;
    }

    .gallery-item {
      min-height: 200px;
    }

    .lightbox-swiper {
      max-height: 50vh;
    }

  }
</style>

<script>
  // Данные изображений
  const galleryData = [
    {
      src: "https://raw.githubusercontent.com/RT-AGENCY/srubsibir-images/main/main/job/job-1.webp",
      title: "Деревянный дом из сосны",
      description: "Строительство коттеджа 120 кв.м из отборной сосны с применением канадской рубки"
    },
    {
      src: "https://raw.githubusercontent.com/RT-AGENCY/srubsibir-images/main/main/job/job-2.webp",
      title: "Русская баня",
      description: "Баня с комнатой отдыха 40 кв.м, построенная по традиционной технологии"
    },
    {
      src: "https://raw.githubusercontent.com/RT-AGENCY/srubsibir-images/main/main/job/job-3.webp",
      title: "Дом с резными элементами",
      description: "Элитный коттедж из кедра с эксклюзивными резными украшениями"
    },
    {
      src: "https://raw.githubusercontent.com/RT-AGENCY/srubsibir-images/main/main/job/job-4.webp",
      title: "Современный деревянный дом",
      description: "Дом в современном стиле 180 кв.м с панорамными окнами"
    },
    {
      src: "https://raw.githubusercontent.com/RT-AGENCY/srubsibir-images/main/main/job/job-5.webp",
      title: "Двухэтажный дом",
      description: "Просторный семейный дом 220 кв.м с мансардой и террасой"
    },
    {
      src: "https://raw.githubusercontent.com/RT-AGENCY/srubsibir-images/main/main/job/job-6.webp",
      title: "Банный комплекс",
      description: "Баня с террасой и мангальной зоной для полноценного отдыха"
    },
    {
      src: "https://raw.githubusercontent.com/RT-AGENCY/srubsibir-images/main/main/job/job-7.webp",
      title: "Дом из лиственницы",
      description: "Прочный и долговечный дом 150 кв.м из сибирской лиственницы"
    },
    {
      src: "https://raw.githubusercontent.com/RT-AGENCY/srubsibir-images/main/main/job/job-8.webp",
      title: "Дом с мансардой",
      description: "Уютный дом с мансардным этажом 160 кв.м и балконом"
    }
  ];
  let lightboxSwiper;
  let currentSlideIndex = 0;

  // Инициализация при загрузке страницы
  console.log('test')
  document.addEventListener('DOMContentLoaded', function () {
    console.log('tsss')
    // Добавляем обработчики клика на галерею
    const galleryItems = document.querySelectorAll('.gallery-item');
    console.log('ga', galleryItems)
    galleryItems.forEach(item => {
      item.addEventListener('click', function () {
        const index = parseInt(this.dataset.index);
        console.log('ttt')
        openLightbox(index);
      });
    });

    function openLightbox(startIndex = 0) {
      console.log('test open')
      const modal = document.getElementById('lightboxModal');
      const swiperWrapper = modal.querySelector('.swiper-wrapper');

      // Очищаем предыдущие слайды
      swiperWrapper.innerHTML = '';
      console.log('gal', galleryData)
      // Создаем слайды
      galleryData.forEach((item, index) => {
        const slide = document.createElement('div');
        slide.className = 'swiper-slide';
        slide.innerHTML = `<img src="${item.src}" alt="${item.title}" loading="lazy">`;
        swiperWrapper.appendChild(slide);
      });

      // Показываем модальное окно
      modal.classList.add('active');
      document.body.style.overflow = 'hidden';

      // Инициализируем или обновляем Swiper
      if (lightboxSwiper) {
        lightboxSwiper.destroy(true, true);
      }

      setTimeout(() => {
        lightboxSwiper = new Swiper('.lightbox-swiper', {
          loop: true,
          initialSlide: startIndex,
          centeredSlides: true,
          spaceBetween: 30,
          speed: 600,
          effect: 'slide',

          // Навигация
          navigation: {
            nextEl: '.swiper-button-next',
            prevEl: '.swiper-button-prev',
          },

          // Пагинация
          pagination: {
            el: '.swiper-pagination',
            clickable: true,
            dynamicBullets: true,
          },

          // Управление клавиатурой
          keyboard: {
            enabled: true,
            onlyInViewport: true,
          },

          // Управление мышью
          mousewheel: {
            enabled: true,
            sensitivity: 1,
          },

          // События
          on: {
            slideChange: function () {
              currentSlideIndex = this.realIndex;
              updateSlideInfo(currentSlideIndex);
            }
          }
        });

        // Обновляем информацию для первого слайда
        updateSlideInfo(startIndex);
      }, 100);
    }
    // Обработчик закрытия по Escape
    document.addEventListener('keydown', function (e) {
      if (e.key === 'Escape') {
        closeLightbox();
      }
    });
  });



  function closeLightbox() {
    const modal = document.getElementById('lightboxModal');
    modal.classList.remove('active');
    document.body.style.overflow = '';

    if (lightboxSwiper) {
      lightboxSwiper.destroy(true, true);
      lightboxSwiper = null;
    }
  }

  function updateSlideInfo(index) {
    const title = document.querySelector('.lightbox-title');
    const description = document.querySelector('.lightbox-description');

    if (title && description && galleryData[index]) {
      title.textContent = galleryData[index].title;
      description.textContent = galleryData[index].description;
    }
  }
  function showAllProjects() {
    // Здесь можно добавить переход на страницу со всеми проектами
    alert('Переход на страницу со всеми проектами');
  }

  // Предотвращаем закрытие при клике на содержимое - добавляем после загрузки DOM
  document.addEventListener('DOMContentLoaded', function () {
    // Предотвращаем закрытие при клике на слайдер
    const lightboxSwiperEl = document.querySelector('.lightbox-swiper');
    if (lightboxSwiperEl) {
      lightboxSwiperEl.addEventListener('click', function (e) {
        e.stopPropagation();
        console.log('Клик по слайдеру - не закрываем лайтбокс');
      });
    }

    // Предотвращаем закрытие при клике на информацию
    const lightboxInfoEl = document.querySelector('.lightbox-info');
    if (lightboxInfoEl) {
      lightboxInfoEl.addEventListener('click', function (e) {
        e.stopPropagation();
        console.log('Клик по информации - не закрываем лайтбокс');
      });
    }

    console.log('Обработчики предотвращения закрытия добавлены');
  });
</script>